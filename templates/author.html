{% extends "repo.html" %}

{% load filters %}

{% block branch %}
    <h5>
        <i class='icon-code-fork'></i>
        {{ branch.name }}
    </h5>
{% endblock %}

{% block breadcrumb %}
    {{ block.super }}

    <li>
        <a href='{% url "parsr.views.branch.view" branch_id=branch.id %}'>{{ branch.repo.url }} ({{ branch.name }})</a>
    </li>
{% endblock %}

{% block active%}
    <li class='active'>{{ author.name }}</li>
{% endblock %}

{% block content %}
    <div class='container'>
    <h1>
        {% gravatar author.email %}
        {{ author.name }}

        {% if author.email %}
            <small>({{ author.email }})</small>
        {% endif %}
    </h1>

    <select class='compare'>
        <option>Compare To</option>

        {% with author as current_author %}
            {% for author in branch.authors|ranked %}
                {% if not author == current_author %}
                    <option value="{{ author|href }}">{{ author.name }} ({{ author|rank:branch }})</option>
                {% endif %}
            {% endfor %}
        {% endwith %}
    </select>

    <hr />

    {% include "includes/metrics.html" %}
</div>

{% endblock %}

{% block specific %}
    <script type="text/javascript">
        $(document).ready(function() {
            $(".compare").change(function() {
                var author = $(this).val();

                window.location.href = "{{ branch|href }}{{ author|href }}/compare" + author;
            });
        });
    </script>
{% endblock %}

{% block script %}
    {{ block.super }}

    <script type="text/javascript">
        $(document).ready(function() {
            $(".score").each(function() {
                var score = new analyzr.plugins.Score(this);
                score.load();
            });
        });
    </script>
{% endblock %}
